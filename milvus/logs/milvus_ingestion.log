2025-12-05 00:48:22,050 - INFO - Connecting to Milvus at localhost:19530
2025-12-05 00:48:22,063 - INFO - ✓ Connected to Milvus
2025-12-05 00:48:22,068 - INFO - Creating collection: arxiv_papers
2025-12-05 00:48:22,087 - INFO - ✓ Collection created
2025-12-05 00:48:22,087 - INFO - 
Found 9 partitions to ingest
2025-12-05 00:48:22,088 - INFO - Partitions: ['part-0000', 'part-0001', 'part-0002', 'part-0003', 'part-0004', 'part-0005', 'part-0006', 'part-0007', 'part-0008']

2025-12-05 00:48:22,088 - INFO - 
============================================================
2025-12-05 00:48:22,088 - INFO - Ingesting: part-0000
2025-12-05 00:48:22,088 - INFO - ============================================================
2025-12-05 00:48:22,088 - INFO - Loading: embed/embeddings/full/part-0000_embeddings.npy
2025-12-05 00:48:22,097 - INFO - Loading: embed/embeddings/full/part-0000_metadata.parquet
2025-12-05 00:48:22,566 - INFO - ✓ Loaded 69,453 records from part-0000
2025-12-05 00:48:22,879 - ERROR - Error inserting batch 0: <ParamError: (code=1, message=field (paper_id) expects string input, got: <class 'int'>)>
2025-12-05 00:48:22,879 - ERROR - Error during ingestion: <ParamError: (code=1, message=field (paper_id) expects string input, got: <class 'int'>)>
Traceback (most recent call last):
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/milvus/ingest.py", line 278, in main
    ingestor.ingest_all_partitions()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/milvus/ingest.py", line 199, in ingest_all_partitions
    self.ingest_partition(partition_name)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/milvus/ingest.py", line 162, in ingest_partition
    self.collection.insert(batch_data)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/orm/collection.py", line 519, in insert
    return conn.batch_insert(
           ~~~~~~~~~~~~~~~~~^
        self._name,
        ^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/decorators.py", line 271, in handler
    raise e from e
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/decorators.py", line 263, in handler
    return func(*args, **kwargs)
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/decorators.py", line 322, in handler
    return func(self, *args, **kwargs)
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/decorators.py", line 196, in handler
    raise e from e
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/decorators.py", line 166, in handler
    return func(*args, **kwargs)
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/grpc_handler.py", line 766, in batch_insert
    raise err from err
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/grpc_handler.py", line 747, in batch_insert
    request = self._prepare_batch_insert_request(
        collection_name, entities, partition_name, timeout, **kwargs
    )
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/grpc_handler.py", line 731, in _prepare_batch_insert_request
    else Prepare.batch_insert_param(collection_name, entities, partition_name, fields_info)
         ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/prepare.py", line 1178, in batch_insert_param
    return cls._parse_batch_request(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        request,
        ^^^^^^^^
    ...<2 lines>...
        location,
        ^^^^^^^^^
    )
    ^
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/prepare.py", line 1154, in _parse_batch_request
    field_data = entity_helper.entity_to_field_data(
        entity, fields_info[location[field_name]], request.num_rows
    )
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/entity_helper.py", line 612, in entity_to_field_data
    entity_to_str_arr(entity_values, field_info, CHECK_STR_ARRAY)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/entity_helper.py", line 181, in entity_to_str_arr
    return convert_to_str_array(entity_values, field_info, check=check)
  File "/Users/akhil/Documents/workplace/Distributed Semantic Search/Distributed-Semantic-Search/.venv/lib/python3.14/site-packages/pymilvus/client/entity_helper.py", line 169, in convert_to_str_array
    raise ParamError(
        message=f"field ({field_info['name']}) expects string input, got: {type(s)}"
    )
pymilvus.exceptions.ParamError: <ParamError: (code=1, message=field (paper_id) expects string input, got: <class 'int'>)>
2025-12-05 00:48:22,881 - INFO - ✓ Disconnected from Milvus
2025-12-05 00:48:58,632 - INFO - Connecting to Milvus at localhost:19530
2025-12-05 00:48:58,650 - INFO - ✓ Connected to Milvus
2025-12-05 00:48:58,653 - WARNING - Dropping existing collection: arxiv_papers
2025-12-05 00:48:58,662 - INFO - Creating collection: arxiv_papers
2025-12-05 00:48:58,672 - INFO - ✓ Collection created
2025-12-05 00:48:58,673 - INFO - 
Found 9 partitions to ingest
2025-12-05 00:48:58,673 - INFO - Partitions: ['part-0000', 'part-0001', 'part-0002', 'part-0003', 'part-0004', 'part-0005', 'part-0006', 'part-0007', 'part-0008']

2025-12-05 00:48:58,673 - INFO - 
============================================================
2025-12-05 00:48:58,673 - INFO - Ingesting: part-0000
2025-12-05 00:48:58,673 - INFO - ============================================================
2025-12-05 00:48:58,673 - INFO - Loading: embed/embeddings/full/part-0000_embeddings.npy
2025-12-05 00:48:58,678 - INFO - Loading: embed/embeddings/full/part-0000_metadata.parquet
2025-12-05 00:48:59,026 - INFO - ✓ Loaded 69,453 records from part-0000
2025-12-05 00:49:04,386 - INFO - ✓ Inserted 69,453 records from part-0000
2025-12-05 00:49:04,387 - INFO - ✓ Total inserted so far: 82,453
2025-12-05 00:49:04,489 - INFO - 
============================================================
2025-12-05 00:49:04,489 - INFO - Ingesting: part-0001
2025-12-05 00:49:04,489 - INFO - ============================================================
2025-12-05 00:49:04,489 - INFO - Loading: embed/embeddings/full/part-0001_embeddings.npy
2025-12-05 00:49:04,511 - INFO - Loading: embed/embeddings/full/part-0001_metadata.parquet
2025-12-05 00:49:04,841 - INFO - ✓ Loaded 64,144 records from part-0001
2025-12-05 00:49:10,335 - INFO - ✓ Inserted 64,144 records from part-0001
2025-12-05 00:49:10,336 - INFO - ✓ Total inserted so far: 158,597
2025-12-05 00:49:10,472 - INFO - 
============================================================
2025-12-05 00:49:10,472 - INFO - Ingesting: part-0002
2025-12-05 00:49:10,472 - INFO - ============================================================
2025-12-05 00:49:10,472 - INFO - Loading: embed/embeddings/full/part-0002_embeddings.npy
2025-12-05 00:49:10,488 - INFO - Loading: embed/embeddings/full/part-0002_metadata.parquet
2025-12-05 00:49:10,874 - INFO - ✓ Loaded 61,807 records from part-0002
2025-12-05 00:49:17,573 - INFO - ✓ Inserted 61,807 records from part-0002
2025-12-05 00:49:17,575 - INFO - ✓ Total inserted so far: 232,404
2025-12-05 00:49:17,652 - INFO - 
============================================================
2025-12-05 00:49:17,652 - INFO - Ingesting: part-0003
2025-12-05 00:49:17,652 - INFO - ============================================================
2025-12-05 00:49:17,652 - INFO - Loading: embed/embeddings/full/part-0003_embeddings.npy
2025-12-05 00:49:17,766 - INFO - Loading: embed/embeddings/full/part-0003_metadata.parquet
2025-12-05 00:49:18,355 - INFO - ✓ Loaded 60,240 records from part-0003
2025-12-05 00:49:25,928 - INFO - ✓ Inserted 60,240 records from part-0003
2025-12-05 00:49:25,930 - INFO - ✓ Total inserted so far: 304,644
2025-12-05 00:49:26,102 - INFO - 
============================================================
2025-12-05 00:49:26,102 - INFO - Ingesting: part-0004
2025-12-05 00:49:26,102 - INFO - ============================================================
2025-12-05 00:49:26,102 - INFO - Loading: embed/embeddings/full/part-0004_embeddings.npy
2025-12-05 00:49:26,117 - INFO - Loading: embed/embeddings/full/part-0004_metadata.parquet
2025-12-05 00:49:26,470 - INFO - ✓ Loaded 58,910 records from part-0004
2025-12-05 00:49:34,032 - INFO - ✓ Inserted 58,910 records from part-0004
2025-12-05 00:49:34,034 - INFO - ✓ Total inserted so far: 374,554
2025-12-05 00:49:34,344 - INFO - 
============================================================
2025-12-05 00:49:34,344 - INFO - Ingesting: part-0005
2025-12-05 00:49:34,344 - INFO - ============================================================
2025-12-05 00:49:34,344 - INFO - Loading: embed/embeddings/full/part-0005_embeddings.npy
2025-12-05 00:49:34,396 - INFO - Loading: embed/embeddings/full/part-0005_metadata.parquet
2025-12-05 00:49:34,717 - INFO - ✓ Loaded 58,070 records from part-0005
2025-12-05 00:49:39,463 - INFO - ✓ Inserted 58,070 records from part-0005
2025-12-05 00:49:39,464 - INFO - ✓ Total inserted so far: 443,624
2025-12-05 00:49:39,618 - INFO - 
============================================================
2025-12-05 00:49:39,619 - INFO - Ingesting: part-0006
2025-12-05 00:49:39,619 - INFO - ============================================================
2025-12-05 00:49:39,619 - INFO - Loading: embed/embeddings/full/part-0006_embeddings.npy
2025-12-05 00:49:39,635 - INFO - Loading: embed/embeddings/full/part-0006_metadata.parquet
2025-12-05 00:49:40,086 - INFO - ✓ Loaded 57,151 records from part-0006
2025-12-05 00:49:44,560 - INFO - ✓ Inserted 57,151 records from part-0006
2025-12-05 00:49:44,560 - INFO - ✓ Total inserted so far: 511,775
2025-12-05 00:49:44,635 - INFO - 
============================================================
2025-12-05 00:49:44,636 - INFO - Ingesting: part-0007
2025-12-05 00:49:44,636 - INFO - ============================================================
2025-12-05 00:49:44,636 - INFO - Loading: embed/embeddings/full/part-0007_embeddings.npy
2025-12-05 00:49:44,650 - INFO - Loading: embed/embeddings/full/part-0007_metadata.parquet
2025-12-05 00:49:44,969 - INFO - ✓ Loaded 56,000 records from part-0007
2025-12-05 00:49:49,345 - INFO - ✓ Inserted 56,000 records from part-0007
2025-12-05 00:49:49,345 - INFO - ✓ Total inserted so far: 578,775
2025-12-05 00:49:49,420 - INFO - 
============================================================
2025-12-05 00:49:49,420 - INFO - Ingesting: part-0008
2025-12-05 00:49:49,420 - INFO - ============================================================
2025-12-05 00:49:49,420 - INFO - Loading: embed/embeddings/full/part-0008_embeddings.npy
2025-12-05 00:49:49,436 - INFO - Loading: embed/embeddings/full/part-0008_metadata.parquet
2025-12-05 00:49:49,590 - INFO - ✓ Loaded 24,428 records from part-0008
2025-12-05 00:49:51,181 - INFO - ✓ Inserted 24,428 records from part-0008
2025-12-05 00:49:51,182 - INFO - ✓ Total inserted so far: 607,203
2025-12-05 00:49:51,202 - INFO - 
============================================================
2025-12-05 00:49:51,202 - INFO - ✓ INGESTION COMPLETE
2025-12-05 00:49:51,202 - INFO - ============================================================
2025-12-05 00:49:51,202 - INFO - Total records inserted: 607,203
2025-12-05 00:49:51,202 - INFO - Total time: 0.88 minutes
2025-12-05 00:49:51,202 - INFO - Average rate: 11559 records/sec
2025-12-05 00:49:51,202 - INFO - 
Flushing collection to disk...
2025-12-05 00:49:53,742 - INFO - ✓ Flush complete
2025-12-05 00:49:53,744 - INFO - Compacting collection...
2025-12-05 00:49:53,753 - INFO - ✓ Compaction complete
2025-12-05 00:49:53,753 - INFO - 
============================================================
2025-12-05 00:49:53,753 - INFO - Building IVF_FLAT index...
2025-12-05 00:49:53,753 - INFO - ============================================================
2025-12-05 00:50:16,323 - INFO - ✓ Index built in 0.38 minutes
2025-12-05 00:50:16,338 - INFO - 
Loading collection into memory...
2025-12-05 00:50:27,630 - INFO - ✓ Collection loaded and ready for queries
2025-12-05 00:50:27,728 - INFO - 
============================================================
2025-12-05 00:50:27,728 - INFO - COLLECTION STATISTICS
2025-12-05 00:50:27,728 - INFO - ============================================================
2025-12-05 00:50:27,732 - INFO - Total entities: 510,203
2025-12-05 00:50:27,732 - INFO - Has index: True
2025-12-05 00:50:27,732 - INFO - Loaded: Loaded
2025-12-05 00:50:27,732 - INFO - ============================================================

2025-12-05 00:50:27,767 - INFO - ✓ Disconnected from Milvus
